<?php
/**
 * @category    M2Commerce Enterprise
 * @package     M2Commerce_OrderComment
 * @copyright   Copyright (c) 2025 M2Commerce Enterprise
 * @author      dawoodgondaldev@gmail.com
 */

/** @var \Magento\Framework\View\Element\Template $block */
$objectManager = \Magento\Framework\App\ObjectManager::getInstance();
/** @var \Magento\Framework\Escaper $escaper */
$escaper = $objectManager->get(\Magento\Framework\Escaper::class);

$videoUrl = $block->getData('video_url');
$title = $block->getData('title') ?: 'YouTube Video';
$width = $block->getData('width') ?: '560';
$height = $block->getData('height') ?: '315';
$autoplay = $block->getData('autoplay') ?: '0';

parse_str(parse_url($videoUrl, PHP_URL_QUERY), $urlParams);
$videoId = $urlParams['v'] ?? null;
?>

<?php if ($videoId): ?>
    <div class="youtube-widget" style="text-align:center; margin:20px 0;">
        <h2><?= $escaper->escapeHtmlAttr($title) ?></h2>
        <iframe width="<?= $escaper->escapeHtmlAttr($width) ?>"
                height="<?= $escaper->escapeHtmlAttr($height) ?>"
                src="https://www.youtube.com/embed/<?= $escaper->escapeHtmlAttr($videoId) ?>?autoplay=<?= $escaper->escapeHtmlAttr($autoplay) ?>"
                title="<?= $escaper->escapeHtmlAttr($title) ?>"
                frameborder="0"
                allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                allowfullscreen>
        </iframe>
    </div>
<?php endif; ?>
